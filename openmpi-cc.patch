--- openmpi-1.2.5/config/ompi_setup_cc.m4~	2007-02-16 20:20:47.000000000 +0200
+++ openmpi-1.2.5/config/ompi_setup_cc.m4	2008-01-09 01:58:57.243359737 +0200
@@ -279,9 +279,16 @@
     #
     ompi_cflags_save="$CFLAGS"
     AC_PROG_CC
-    BASECC="`basename $CC`"
+    BASECC=`basename "$CC"`
     CFLAGS="$ompi_cflags_save"
     AC_DEFINE_UNQUOTED(OMPI_CC, "$CC", [OMPI underlying C compiler])
-    OMPI_CC_ABSOLUTE="`which $CC`"
+	case "$CC" in
+	/*)
+		OMPI_CC_ABSOLUTE=$CC
+		;;
+	*)
+		# XXX still breaks when CC="ccache gcc"
+		OMPI_CC_ABSOLUTE=`which "$CC"`
+	esac
     AC_SUBST(OMPI_CC_ABSOLUTE)
 ])
--- openmpi-1.2.5/./config/ompi_setup_cxx.m4~	2006-12-18 00:45:07.000000000 +0200
+++ openmpi-1.2.5/./config/ompi_setup_cxx.m4	2008-01-09 02:02:27.958453138 +0200
@@ -250,10 +250,17 @@
     ompi_cxxflags_save="$CXXFLAGS"
     AC_PROG_CXX
     AC_PROG_CXXCPP
-    BASECXX="`basename $CXX`"
+    BASECXX=`basename "$CXX"`
     CXXFLAGS="$ompi_cxxflags_save"
     AC_DEFINE_UNQUOTED(OMPI_CXX, "$CXX", [OMPI underlying C++ compiler])
-    OMPI_CXX_ABSOLUTE="`which $CXX`"
+	case "$CXX" in
+	/*)
+		OMPI_CXX_ABSOLUTE=$CXX
+		;;
+	*)
+		# XXX still breaks when CXX="ccache g++"
+		OMPI_CXX_ABSOLUTE=`which "$CXX"`
+	esac
     AC_SUBST(OMPI_CXX_ABSOLUTE)
 
     OMPI_CXX_COMPILER_VENDOR([ompi_cxx_vendor])
